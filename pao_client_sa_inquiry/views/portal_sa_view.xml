<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="portal_my_home_service_agreements" name="Show Service Agreements" customize_show="True" inherit_id="portal.portal_my_home" priority="50">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="before">
            <t t-set="portal_service_category_enable" t-value="True"/>
        </xpath>
        <div id="portal_service_category" position="inside">
            <t t-if="len(request.env.user.partner_id.pao_agreements_ids) > 0" t-call="portal.portal_docs_entry">
                <t t-set="icon" t-value="'/purchase/static/src/img/rfq.svg'"/>
                <t t-set="text">Manage your service agreements</t>
                <t t-set="title">Service Agreements</t>
                <t t-set="url" t-value="'/my/service_agreements'"/>
                <t t-set="config_card" t-value="True"/>
            </t>
        </div>
    </template>

    <template id="portal_breadcrumbs_service_agreements" inherit_id="portal.portal_breadcrumbs">
        <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">

            <li t-if="page_name == 'partner_sa_list'" class="breadcrumb-item">Service Agreements</li>

            <!-- <t t-if="page_name == 'expense_report_form_view'">
                <li class="breadcrumb-item">
                    <a href="/my/expense_reports">Expense Reports</a>
                </li>
                <li t-if="report" class="breadcrumb-item">
                    <t t-out="report.name"/>
                </li>
            </t>

            <t t-if="page_name == 'wallet_expenses'">
                <li class="breadcrumb-item">
                    <a href="/my/expense_reports">Expense Reports</a>
                </li>
                <li class="breadcrumb-item">
                    Wallet
                </li>
            </t> -->

        </xpath>
    </template>


    <template id="my_service_agreements_view" name="My Service Agreements">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="portal.portal_searchbar">
                <t t-set="title">Service Agreements</t>
            </t>
            <t t-if="not service_agreements">
                <p class="alert alert-warning">There are currently no service agreements for your account.</p>
            </t>
            <table t-if="service_agreements" class="o_list_table position-relative table table-sm o_list_table_ungrouped table-striped o_portal_my_doc_table mb-0 table-hover">
                <thead>
                    <tr class="active">
                        <th>Summary</th>
                        <th>Creation Date</th>
                        <th>Document Status</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="service_agreements" t-as="agreement">
                        <tr>
                            <td>
                                <span t-field="agreement.title"/>
                            </td>
                            <td>
                                <span t-field="agreement.document_date"/>
                            </td>
                            <td style="font-size: larger !important">
                                <t t-if="agreement.document_status == 'sign'">
                                    <span class="badge rounded-pill text-bg-success">
                                        <span t-field="agreement.document_status"/>
                                    </span>
                                </t>
                                <t t-elif="agreement.document_status == 'sent'">
                                    <span class="badge rounded-pill text-bg-info">
                                        <span t-field="agreement.document_status"/>
                                    </span>
                                </t>
                                <t t-elif="agreement.document_status == 'partially_sign'">
                                    <span class="badge rounded-pill text-bg-secondary">
                                        <span t-field="agreement.document_status"/>
                                    </span>
                                </t>
                            </td>
                            <td>
                                <a t-if="agreement.document_status == 'sent'" class="btn btn-primary" target="_blank" t-att-href="agreement.sign_url">Sign SA</a>
                                <a t-if="agreement.document_status not in ('sent', 'cancel', 'exception')" class="btn btn-primary" t-att-href="'/my_service_agreements/download/attachments/' + str(agreement.id)">Download SA</a>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>
        </t>
    </template>

</odoo>