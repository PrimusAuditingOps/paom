<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="pao_child_sales_order_line_view_form" model="ir.ui.view">
        <field name="name">pao.child.sales.order.line.view.form</field>
        <field name="model">pao.child.sales.order.line</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group col="2"> 
                        <field name="sale_order_id" invisible="1" options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        <field name="partner_id" placeholder="Search customer..." options="{'no_quick_create': True, 'no_create_edit' : True}"/>
                        
                    </group>
                    <!--
                    <notebook>
                        <page string="Order line">
                            <field name="order_line_detail_id" widget="section_and_note_one2many" mode="tree"  domain="[('child_sale_order_id', '=', id)]" create="false">
                                <tree string="Orders line" editable="bottom" create="false" edit="false">
                                    <field name="name" widget="section_and_note_text"/>
                                    <field name="audit_products" attrs="{'readonly': True}"   widget="many2many_tags" options="{'color_field': 'color','no_quick_create': True, 'no_create_edit' : True}"/>
                                    <field name="organization_id"  attrs="{'readonly': True}"  options="{'no_quick_create': True, 'no_create_edit' : True}" optional="show"/>
                                    <field name="registrynumber_id" attrs="{'readonly': True}"  domain="[('organization_id', '=', organization_id)]" options="{'no_quick_create': True, 'no_create_edit' : True}" optional="show"/>
                                    <field name="service_start_date" attrs="{'readonly': True}"  optional="show"/>
                                    <field name="service_end_date"  attrs="{'readonly': True}"  optional="show"/>
                                    
                                </tree>
                            </field>
                        </page>
                    </notebook>
                    -->
                </sheet>
                <footer>
                   <button string="Create" name="create_request" type="object" class="btn-primary"/>
                   <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <record id="action_pao_child_sales_order_line" model="ir.actions.act_window">
        <field name="name">Sub-Order</field>
        <field name="res_model">pao.child.sales.order.line</field>
        <field name="target">new</field>
        <field name="view_mode">form</field>
    </record>
    <record id="sale_child_order_view_form" model="ir.ui.view">
        <field name="name">sale.child.order.view.form</field>
        <field name="model">sale.order</field>
        <field name="type">form</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">    
            <xpath expr="//button[@name='%(pao_sign_sa.action_sa_send_request)d']" position="attributes">
                <field name="country_code" invisible="1"/>
                <attribute name="invisible">country_code != 'US' or pao_is_a_master_sales_order == True or pao_is_a_child_sales_order and not pao_is_parent_id_locked</attribute>  
            </xpath>              
            <xpath expr="//button[@name='action_cancel']" position="after">  

                <field name="pao_is_parent_id_locked" invisible="1"/>
                <field name="pao_is_a_master_sales_order" invisible="1"/>
                <field name="pao_is_a_child_sales_order" invisible="1"/>
                <field name="invoice_status" invisible="1"/>
                <button name="action_conver_to_master" string="Convert to Master Order" title="Convert to Master Order"
                type="object" invisible="country_code != 'US' or invoice_status == 'invoiced' or pao_is_a_master_sales_order or pao_is_a_child_sales_order"/>
                <button name="%(pao_master_sales_order.action_pao_child_sales_order_line)d" string="Create Sub Order" title="Create Sub-Order"
                type="action" invisible="country_code != 'US' or pao_is_a_master_sales_order == False" context="{'default_sale_order_id': id}"/>
                
                <button name="action_master_order_lock" type="object" string="Lock" help="If the sale is locked, you can not modify it anymore." 
                invisible="country_code != 'US' or locked or not locked and state == 'sale' or pao_is_a_child_sales_order"/>
            </xpath> 
             <field name="payment_term_id" position="after">
                <field name="pao_parent_id" invisible="country_code != 'US' or pao_is_a_child_sales_order == False"/>
            </field>
             <div name="button_box" position="inside">
                <button name="action_view_children_orders" type="object" class="oe_stat_button" 
                icon="fa-files-o" invisible="country_code != 'US' or pao_children_orders_count == 0">
                     <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value"><field name="pao_children_orders_count"/></span>
                        <span class="o_stat_text">Sub-Orders</span>
                    </div>
                </button> 
            </div>
             <div name="button_box" position="after">
                <widget style="opacity: 0.3;" name="web_ribbon" text="Master Order" bg_color="bg-success" tooltip="Master Order" invisible="country_code != 'US' or pao_is_a_master_sales_order == False"/>
                <widget style="opacity: 0.3;" name="web_ribbon" text="Sub-Order" bg_color="bg-warning" tooltip="Sub-Order" invisible="country_code != 'US' or pao_is_a_child_sales_order == False"/>
            </div>


             
                    
        </field>
        
    </record>
</odoo> 